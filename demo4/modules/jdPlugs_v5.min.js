define(['jquery'], function() {
    function ajaxHit(a, b, c) {
        $.ajax({
            url: a,
            beforeSend: function() {
                b.gLoader().block()
            },
            success: function(a) {
                c(a)
            },
            error: function(a) {
                throw new Error("Error", a)
            }
        })
    }

    function google_RemarkettingTag() {
        ! function(a, b, c, d, e) {
            a[d] = a[d] || [], a[d].push({
                "gtm.start": (new Date).getTime(),
                event: "gtm.js"
            });
            var f = b.getElementsByTagName(c)[0],
                g = b.createElement(c),
                h = "dataLayer" != d ? "&l=" + d : "";
            g.async = !0, g.src = "//www.googletagmanager.com/gtm.js?id=" + e + h, f.parentNode.insertBefore(g, f)
        }(window, document, "script", "dataLayer", "GTM-NX744H")
    }

    function similarJobCallBack(a) {
        if (a && a.length) {
            var b, c = "",
                d = [];
            $.each(jQuery.parseJSON(a), function(a, e) {
                b = a % 2 ? "even" : "odd", c += '<div class="hdSec fl ' + b + '"><h2><em></em><a target="_blank" title="' + e.title + '" href="' + e.jobURL + '">' + e.title + "</a></h2><p>" + e.companyName + '</p><p><em class="expIcn"></em><span>' + e.experience + '</span><em class="locIcn"></em><span>' + e.locations + "</span></p></div>", d.push(e.jobId)
            }), c = '<h6 class="small_title">Similar Jobs for You</h6>' + c + '<a target="_blank" href="' + simillarJobsPageUrl + '" class="vall">View All</a>', simJobCont.gLoader().unblock(), simJobCont.append(c), "premium" == jobType && (dataLayer[0].SRP_JOBIDS = d, dataLayer.push({
                event: "AJAXLoaded"
            }), google_RemarkettingTag())
        } else simJobCont.slideUp()
    }

    function viewSimillarJobsUrl(a) {
        "premium" == jobType ? ajaxHit(a, simJobCont, similarJobCallBack) : (google_RemarkettingTag(), simJobCont.inViewCallback({
            repeatInCbFlag: !1,
            inCallback: function() {
                ajaxHit(a, simJobCont, similarJobCallBack)
            }
        }))
    }

    function viewCont_saQ(a) {
        $("#viewCont_trg").on("click.viewCont", function() {
            $(this).off("click.viewCont");
            var b = $(this),
                c = $("#viewContact");
            ajaxHit(a.viewCont, b, function(a) {
                var d = "";
                if (b.hide(), a = jQuery.parseJSON(a), jQuery.isEmptyObject(a.fields) ? d = "Not Mentioned" : $.each(a.fields, function(a, b) {
                        d += "noKey" == a ? "<p><span>" + b + "</span></p>" : "Website" == a ? b.indexOf(".naukri.com") > -1 ? "<p><em>" + a + ':</em><a target="_blank" href="' + b + '">' + b + "</a></p>" : "<p><em>" + a + ':</em><a target="_blank" rel="nofollow" href="' + b + '">' + b + "</a></p>" : "Email Address" == a ? "<p><em>" + a + ':</em><span><img title="' + b.title + '" src="data:image/jpeg;base64,' + b.src + '"></span></p>' : "<p><em>" + a + ":</em><span>" + b + "</span></p>"
                    }), c.html(d).slideDown(), a.hiddenFields.showSendQuery) {
                    var e = a.sendQueryForm;
                    $("#saQ").append(e.html).slideDown(), $("#saQ_form .rowR p").on("click", "em,span", function() {
                        $(this).parent().toggleClass("unChk chk"), $(this).parent().hasClass("chk") ? $("#isSMJLT").val(1) : $(this).parent().hasClass("unChk") && $("#isSMJLT").val(0)
                    });
                    var f = new commonValidator;
                    f.validate({
                        formNames: ["sendQ"],
                        errors: common_ErrorList,
                        styles: {
                            errorClass: "err",
                            okClass: "ok",
                            parentObjectClass: "row",
                            maxLevel: 2
                        }
                    }), uploader1 = new ncUploader({
                        appId: 109,
                        containerId: "saQ_uploadCont",
                        fileKeys: [e.fileKey],
                        formKey: e.formKey,
                        forceBasicUploader: !1,
                        targets: {
                            saveFileUrl: e.upload_url,
                            saveCloudUrl: e.file_url,
                            deleteUrl: e.delete_url
                        },
                        outputHolder: {
                            id: "results",
                            cssClass: "outputCss"
                        },
                        dropAreaParams: {
                            id: "hid_container",
                            onHoverCssClass: "hover"
                        },
                        extensions: e.extensions,
                        maxSize: e.max_file_size,
                        maxNumOfFiles: e.max_num_files,
                        fileId: "saQ_upload",
                        basicProgressBarId: "saQ_basicProgressBar",
                        callbackUrl: uploadCallBackUrl,
                        onDelete: function() {
                            $("#saQ_uploadCont").find(".supDocs").removeClass("uploadErr uploadSucs").html("Supported Formats: doc, docx, rtf, pdf Max file size: 300kb")
                        },
                        callback: function() {
                            for (var a in arguments[0].SUCCESS) $("#file_url").val(arguments[0].SUCCESS[a].URL), $("#file_name").val(arguments[0].SUCCESS[a].name);
                            if ($("#saQ_upload").val(""), "undefined" != typeof arguments[0].ERROR) {
                                var b = "Invalid Format";
                                arguments[0].ERROR.U544792b84e6fb && "FILE SIZE LIMIT EXCEEDED" == arguments[0].ERROR.U544792b84e6fb.error ? b = "INVALID_FILE_TYPE." : arguments[0].ERROR.dummyFileKey && "FILE SIZE LIMIT EXCEEDED" == arguments[0].ERROR.dummyFileKey.error && (b = "File size limit exceeded."), $("#saQ_uploadCont").find(".supDocs").hide().html('<span class="uploadErr">' + b + "</span>, Supported Formats: doc, docx, rtf, pdf Max file size: 300kb").slideDown()
                            } else $("#saQ_uploadCont").find(".supDocs").hide().html("Resume uploaded successfully.").addClass("uploadSucs").slideDown()
                        }
                    }), $("#saQ_upload").on("click", function() {
                        $("#saQ_uploadCont").find(".supDocs").removeClass("uploadSucs").html("Supported Formats: doc, docx, rtf, pdf Max file size: 300kb")
                    })
                }
            }, function() {
                c.slideUp()
            })
        })
    }
    $("#rtjSbt").on("click", function() {
        if (rtjFrmValid.isValid()) {
            var a = $("#rtjFrm").serialize();
            $.ajax({
                type: "POST",
                url: urlReportAbuse,
                data: a,
                timeout: 3e4,
                beforeSend: function() {
                    $("#rtjLBMain").gLoader().block()
                },
                success: function() {
                    $("#rtj").hide(), $("#rtjMsg").addClass("green").find(".cnt").html("Thank you for your feedback. This will help us improve the quality of jobs that are available on naukri.com for you.")
                },
                error: function() {
                    $("#rtjMsg").addClass("red").find(".cnt").html("Woops! Something went wrong while submitting. Please try again.")
                },
                complete: function() {
                    $("#rtj").lightBox().close();
                    var a = $("#rtjMsg");
                    $("body,html").animate({
                        scrollTop: 0
                    }, "500", "swing", function() {
                        a.slideDown()
                    }), setTimeout(function() {
                        a.slideUp()
                    }, 5e3), $("#rtjLBMain").gLoader().unblock()
                }
            })
        }
    }), $("#etjSbt").on("click", function() {
        if (etjFrmValid.isValid()) {
            var a = $("#etjFrm").serialize();
            $.ajax({
                type: "POST",
                url: urlEmailThisJob,
                data: a,
                timeout: 3e4,
                beforeSend: function() {
                    $("#etjLBMain").gLoader().block()
                },
                success: function() {
                    $("#rtjMsg").addClass("green").find(".cnt").html("Job details has been successfully e-mailed to your friend ")
                },
                error: function() {
                    $("#rtjMsg").addClass("red").find(".cnt").html("Woops! Something went wrong while submitting. Please try again.")
                },
                complete: function() {
                    $("#etj").lightBox().close();
                    var a = $("#rtjMsg");
                    $("body,html").animate({
                        scrollTop: 0
                    }, "500", "swing", function() {
                        a.slideDown()
                    }), setTimeout(function() {
                        a.slideUp()
                    }, 5e3), $("#etjLBMain").gLoader().unblock(), $("#etjFrm")[0].reset()
                }
            })
        }
    });
    var SAPCJAOptions = {
            ltBox: $("#notLoggedCJA"),
            dimens: {
                width: "770px"
            },
            open: {
                anim: {
                    className: "flipOpen"
                }
            },
            close: {
                nodes: $("#notLoggedCls"),
                anim: {
                    className: "flipClose",
                    duration: 300
                }
            }
        },
        rtjLBOptions = {
            ltBox: $("#rtjLBMain"),
            resetForm: !1,
            dimens: {
                width: "700px"
            },
            open: {
                success: function() {
                    rtjFrmValid.hideElement("otherOpt"), $("#opt7").on("change", function() {
                        var a = $(this).parent().siblings("#otherOpt");
                        $(this).is(":checked") ? (rtjFrmValid.showElement("otherOpt"), a.slideDown(100)) : (a.val("").slideUp(100), rtjFrmValid.hideElement("otherOpt"), $("#rtjFrm #otherOpt_err").removeClass("err"))
                    })
                },
                event: "click",
                anim: {
                    className: "flipOpen"
                }
            },
            close: {
                nodes: $("#rtjLBCls"),
                layer: !0,
                anim: {
                    className: "flipClose",
                    duration: 300
                },
                success: function() {
                    $("#rtjFrm #otherOpt").hide(), $("#rtjFrm .erLbl").removeClass("err")
                }
            }
        },
        etjLBOptions = $.extend(!0, etjLBOptions, rtjLBOptions, {
            ltBox: $("#etjLBMain"),
            open: {
                success: function() {
                    etjFrmValid.setDefaultValues($("#etjFrm")), $("#yEml").on("blur", function() {
                        var a = $(this),
                            b = etjFrmValid.isValid("yEml");
                        b && $("#msg").val("Your friend, " + a.val() + " has forwarded this job posting posted on Naukri.com.")
                    })
                }
            },
            close: {
                nodes: $("#etjLBCls"),
                success: function() {
                    $("#etjLBMain").find(".err").removeClass("err")
                }
            }
        });
    $(function() {
        rtjFrmValid = new commonValidator, rtjFrmValid.validate({
            formNames: ["rtjForm"],
            errors: common_ErrorList,
            defaultEvents: ["click"],
            submitButton: ["rtjSbt"]
        }), etjFrmValid = new commonValidator, etjFrmValid.validate({
            formNames: ["etjForm"],
            errors: common_ErrorList,
            styles: {
                errorClass: "err",
                okClass: "ok",
                softMandClass: "softMand",
                parentObjectClass: "row",
                maxLevel: 2
            },
            defaultEvents: ["blur"],
            submitButton: ["etjSbt"]
        }), $("#rtj").lightBox(rtjLBOptions), $("#etj").lightBox(etjLBOptions), $("#tab_fatfooter").tabs()
    });
    var simJobCont = $("#similar_job");
    try {
        var viewPhotoLayer = $("#viewPhotoLayer"),
            downLoadPPT = $("#downLoadPPT"),
            list_thumbnails = viewPhotoLayer.find(".thumbnails .list"),
            initJdMedia = function(a) {
                if (a.ppt && $("#downLoadPPT").attr("href", a.ppt.pptUrl), a.photo) {
                    var b = a.photo.baseThumbnailUrl,
                        c = a.photo.basePhotoUrl,
                        d = a.photo.mediaIds,
                        e = viewPhotoLayer.find(".mainPhoto");
                    for (var f in d) {
                        var g = $("<img>").attr({
                                src: b + d[f] + "/seq/1",
                                title: a.photo.captions[f]
                            }),
                            h = $('<li class="item"></li>');
                        h.append(g), list_thumbnails.append(h)
                    }
                    var i = null;
                    list_thumbnails.on("click", ".item", function() {
                        i && i.removeClass("selected"), $(this).addClass("selected"), i = $(this);
                        var b = $(this).index() % d.length;
                        e.attr({
                            src: c + d[b] + "/seq/1",
                            title: a.photo.captions[b]
                        })
                    }), e.attr({
                        src: c + d[0] + "/seq/1",
                        title: a.photo.captions[0]
                    })
                }
            };
        jdMedia ? initJdMedia(jdMedia) : "";
        var init_jdMedia = !0;
        $("#viewPhoto").lightBox({
            ltBox: $("#viewPhotoLayer"),
            dimens: {
                width: "650px"
            },
            open: {
                success: function() {
                    init_jdMedia && (init_jdMedia = !1, $("#viewPhotoLayer .nCarousel").carousel({
                        shifts: 1,
                        size: 5,
                        autoPlay: !1
                    }))
                }
            },
            close: {
                nodes: $("#viewPhotoLayer .ltGlobalCls")
            }
        })
    } catch (err) {}
    var rtjMsg = $("#rtjMsg");
    "" != eCode && ($("body").animate({
        scrollTop: 0
    }, "500", "swing", function() {
        rtjMsg.slideDown().addClass("red").find(".cnt").html(sqC)
    }), setTimeout(function() {
        rtjMsg.slideUp()
    }, 5e3)), "" != eCnfrm && ($("body").animate({
        scrollTop: 0
    }, "500", "swing", function() {
        rtjMsg.slideDown().addClass("green").find(".cnt").html(sqCn)
    }), setTimeout(function() {
        rtjMsg.slideUp()
    }, 5e3));
    var loginS = !1,
        btnNameS = "",
        boolhitFollow = !1;
    loginS = "" == username ? !1 : !0, "1" == rpFollowStatus ? (btnNameS = "followBtn1", boolhitFollow = !1) : boolhitFollow = !0;
    var followObj = new follow,
        followFn = function(a) {
            rpDataId && "" != rpDataId && "1" == a.FollowerCount.succeed && "1" == a.FollowResponse.succeed && $("#followerCount").html(a.FollowerCount.data)
        };
    followObj.init({
        loginStatus: loginS,
        followingButtons: [btnNameS],
        hitFollowAPI: boolhitFollow,
        actionURL: varActionUrl,
        undoURL: varUndoUrl,
        callBack: followFn
    }), $(document).ready(function() {
        var a = decodeURIComponent(queryParams_qp);
        a && "" != a && (a = a.split(" "), $(".highlightable").highlight(a, {
            element: "font",
            className: "hlite"
        })), viewSimillarJobsUrl(viewSimillarJobs, simillarJobsPageUrl), viewCont_saQ({
            viewCont: viewContUrl
        })
    }), $(function() {
        if (authenticated) $("#idSMJLT").attr("href", urlSendMeJobsLikeThese), $("#idSMJLT").attr("target", "_blank");
        else {
            var a = {
                ltBox: $("#notLoggedCJA"),
                dimens: {
                    width: "770px"
                },
                open: {
                    anim: {
                        className: "flipOpen"
                    }
                },
                close: {
                    nodes: $("#notLoggedCls"),
                    anim: {
                        className: "flipClose",
                        duration: 300
                    }
                }
            };
            if ($("#smjltSbt").on("click", function() {
                    if (b.isValid()) {
                        var c = $("#CJAFrm").serialize();
                        $.ajax({
                            type: "POST",
                            url: urlSendMeJobsLikeThese,
                            data: c,
                            timeout: 3e4,
                            beforeSend: function() {
                                $("#notLoggedCJA").gLoader().block()
                            },
                            success: function(b) {
                                $("#idSMJLT").lightBox(a).close(), $("#notLoggedCJA").gLoader().unblock(), b.url ? window.location.href = b.url : b.error.replacealert ? window.location.href = b.error.replacealert : ($("#rtjMsg").addClass("red").find(".cnt").html("Woops! Something went wrong while submitting. Please try again."), $("#idSMJLT").lightBox(a).close(), $("body").animate({
                                    scrollTop: 0
                                }, "500", "swing", function() {
                                    $("#rtjMsg").slideDown()
                                }), $("#notLoggedCJA").gLoader().unblock())
                            },
                            error: function() {
                                $("#rtjMsg").addClass("red").find(".cnt").html("Woops! Something went wrong while submitting. Please try again."), $("#idSMJLT").lightBox(a).close(), $("body").animate({
                                    scrollTop: 0
                                }, "500", "swing", function() {
                                    $("#rtjMsg").slideDown()
                                }), $("#notLoggedCJA").gLoader().unblock()
                            },
                            complete: function() {}
                        })
                    }
                }), $("#CJAFrm").length) {
                var b = new commonValidator;
                b.validate({
                    formNames: ["CJAFrm"],
                    errors: common_ErrorList,
                    styles: {
                        errorClass: "err",
                        okClass: "ok",
                        softMandClass: "softMand",
                        parentObjectClass: "row",
                        maxLevel: 3
                    },
                    submitButton: ["smjltSbt"]
                }), $("#idSMJLT").lightBox(a)
            }
        }
    }), $("#jdCpName").on("click", function(a) {
        a.preventDefault(), _gaq.push(["_trackEvent", "CompanynameJD", "click", "JD head comapany name"]), window.open($(this).attr("href"), "_blank")
    }), $("#vjbcp").on("click", function(a) {
        a.preventDefault(), _gaq.push(["_trackEvent", "ViewCompanyJD", "click", "View jobs by this company"]), window.open($(this).attr("href"), "_blank")
    });
});
